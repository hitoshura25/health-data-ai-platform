â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ
â–ˆ                                                                           â–ˆ
â–ˆ  Health Platform - Observability Stack Successfully Deployed!            â–ˆ
â–ˆ                                                                           â–ˆ
â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ

Environment: {{ .Values.global.environment }}
Cluster: {{ .Values.global.clusterName }}
Namespace: {{ .Values.global.namespace }}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  DEPLOYED COMPONENTS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{{- if .Values.kube-prometheus-stack.enabled }}
âœ“ Prometheus - Metrics collection (30-day retention)
âœ“ Grafana - Visualization dashboards
âœ“ AlertManager - Alert routing and notifications
{{- end }}

{{- if .Values.jaeger.enabled }}
âœ“ Jaeger - Distributed tracing (OTLP enabled)
{{- end }}

{{- if .Values.loki.enabled }}
âœ“ Loki - Log aggregation (7-day retention)
{{- end }}

{{- if .Values.promtail.enabled }}
âœ“ Promtail - Log shipping (DaemonSet on all nodes)
{{- end }}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  ACCESSING THE DASHBOARDS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{{- if .Values.kube-prometheus-stack.grafana.enabled }}

1. GRAFANA (Visualization & Dashboards)

   Port-forward for local access:

     kubectl port-forward -n {{ .Values.global.namespace }} \
       svc/{{ .Release.Name }}-grafana 3000:80

   Access: http://localhost:3000

   {{- if eq .Values.global.environment "development" }}
   Username: admin
   Password: {{ .Values.kube-prometheus-stack.grafana.adminPassword }}
   {{- else }}
   Username: admin
   Password: <configured in sealed secret>
   {{- end }}

   Pre-configured Dashboards:
     â€¢ Health Platform - Application Overview
     â€¢ Infrastructure Health - Databases & Queues
     â€¢ Cost Monitoring - Oracle Free Tier Usage
     â€¢ Security Dashboard - Authentication & Access
     â€¢ Kubernetes Cluster Overview (from Grafana.com)
     â€¢ Node Exporter Metrics (from Grafana.com)

{{- end }}

{{- if .Values.jaeger.enabled }}

2. JAEGER (Distributed Tracing)

   Port-forward for local access:

     kubectl port-forward -n {{ .Values.global.namespace }} \
       svc/jaeger-query 16686:16686

   Access: http://localhost:16686

   OTLP Endpoints (for service instrumentation):
     â€¢ gRPC: jaeger-collector.{{ .Values.global.namespace }}:4317
     â€¢ HTTP: jaeger-collector.{{ .Values.global.namespace }}:4318

{{- end }}

3. PROMETHEUS (Metrics & Queries)

   Port-forward for local access:

     kubectl port-forward -n {{ .Values.global.namespace }} \
       svc/{{ .Release.Name }}-kube-prometheus-prometheus 9090:9090

   Access: http://localhost:9090

4. ALERTMANAGER (Alert Management)

   Port-forward for local access:

     kubectl port-forward -n {{ .Values.global.namespace }} \
       svc/{{ .Release.Name }}-kube-prometheus-alertmanager 9093:9093

   Access: http://localhost:9093

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  VERIFICATION STEPS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Check all pods are running:

   kubectl get pods -n {{ .Values.global.namespace }}

2. Verify Prometheus is scraping targets:

   kubectl port-forward -n {{ .Values.global.namespace }} \
     svc/{{ .Release.Name }}-kube-prometheus-prometheus 9090:9090

   Visit: http://localhost:9090/targets

3. Check ServiceMonitors are discovered:

   kubectl get servicemonitors -A

4. View Prometheus rules (alerts):

   kubectl get prometheusrules -n {{ .Values.global.namespace }}

5. Test Loki log aggregation:

   kubectl port-forward -n {{ .Values.global.namespace }} \
     svc/{{ .Release.Name }}-loki 3100:3100

   Query: curl http://localhost:3100/loki/api/v1/labels

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  STORAGE USAGE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Check persistent volume usage:

  kubectl get pvc -n {{ .Values.global.namespace }}

Expected storage allocation:
  â€¢ Prometheus: 20 GB (30-day retention)
  â€¢ Jaeger: 10 GB (trace storage)
  â€¢ Loki: 5 GB (7-day log retention)
  â€¢ Grafana: 5 GB (dashboards & settings)
  â€¢ AlertManager: 5 GB (alert history)
  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  Total: 45 GB (within 200 GB free tier)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  IMPORTANT: PRODUCTION CHECKLIST
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

{{- if eq .Values.global.environment "production" }}

Before going to production, ensure:

  [ ] Change Grafana admin password from default
  [ ] Configure AlertManager receivers (Slack, PagerDuty, email)
  [ ] Set up ingress with SSL certificates
  [ ] Configure authentication for Grafana (LDAP/OAuth)
  [ ] Enable auth for Jaeger UI (basic auth or OAuth)
  [ ] Review and adjust alert thresholds
  [ ] Set up backup for Grafana dashboards
  [ ] Test disaster recovery procedures
  [ ] Configure log retention based on compliance requirements
  [ ] Review resource limits vs. actual usage

{{- else }}

NOTE: This is a {{ .Values.global.environment }} deployment.
For production deployment, use: --values values-production.yaml

{{- end }}

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  INSTRUMENTATION GUIDE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

To instrument your services for observability:

1. METRICS (Prometheus)

   Add /metrics endpoint to your services and create ServiceMonitor:

   apiVersion: monitoring.coreos.com/v1
   kind: ServiceMonitor
   metadata:
     name: my-service
     namespace: my-namespace
   spec:
     selector:
       matchLabels:
         app: my-service
     endpoints:
     - port: metrics
       interval: 15s

2. TRACING (Jaeger via OpenTelemetry)

   Configure OTLP exporter in your application:

   OTLP_ENDPOINT: jaeger-collector.{{ .Values.global.namespace }}:4317

3. LOGGING (Loki via Promtail)

   Use structured JSON logging to stdout/stderr:

   {
     "timestamp": "2025-01-19T12:00:00Z",
     "level": "info",
     "service": "my-service",
     "trace_id": "abc123",
     "message": "Request processed"
   }

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  TROUBLESHOOTING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

If pods are not starting:
  â€¢ Check resource availability: kubectl top nodes
  â€¢ View pod events: kubectl describe pod <pod-name> -n {{ .Values.global.namespace }}
  â€¢ Check logs: kubectl logs <pod-name> -n {{ .Values.global.namespace }}

If metrics are not appearing:
  â€¢ Verify ServiceMonitor selectors match Service labels
  â€¢ Check Prometheus targets: http://localhost:9090/targets
  â€¢ Ensure services expose /metrics endpoint

If logs are not aggregating:
  â€¢ Verify Promtail is running on all nodes
  â€¢ Check Promtail logs for errors
  â€¢ Ensure pods are logging to stdout/stderr

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  RESOURCES & DOCUMENTATION
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  â€¢ Prometheus: https://prometheus.io/docs/
  â€¢ Grafana: https://grafana.com/docs/
  â€¢ Jaeger: https://www.jaegertracing.io/docs/
  â€¢ Loki: https://grafana.com/docs/loki/
  â€¢ kube-prometheus-stack: https://github.com/prometheus-community/helm-charts

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Happy Monitoring! ğŸš€ğŸ“ŠğŸ“ˆ

For support, check: /helm-charts/health-platform/charts/observability/README.md
