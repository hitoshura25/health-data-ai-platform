# Health Data AI Platform

An end-to-end pipeline that automatically collects health data from Android Health Connect, stores it in a cloud backend, processes it into clinical narratives, and uses this data to fine-tune and query a personal AI model.

## ğŸ—ï¸ Architecture Overview

This platform consists of 5 main services working together:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Health API     â”‚â”€â”€â”€â–¶â”‚  Message Queue  â”‚â”€â”€â”€â–¶â”‚   Data Lake     â”‚
â”‚   Service       â”‚    â”‚   (RabbitMQ)    â”‚    â”‚   (MinIO S3)    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                       â”‚                       â”‚
         â–¼                       â–¼                       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ AI Query        â”‚â—€â”€â”€â”€â”‚ ETL Narrative   â”‚â—€â”€â”€â”€â”‚ Raw Health Data â”‚
â”‚ Interface       â”‚    â”‚    Engine       â”‚    â”‚   Processing    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ Quick Start

### Prerequisites

- Docker and Docker Compose v2.20+ (for `include` directive)
- Python 3.11+
- OpenSSL (for generating secure credentials)
- Git

### Setup and Run (Under 2 Minutes!)

```bash
# 1. Clone the repository
git clone <repository-url>
cd health-data-ai-platform

# 2. Generate secure configuration for all services
./setup-all-services.sh

# 3. Start all services
docker compose up -d

# 4. Verify services are running
docker compose ps

# 5. Access the Health API
open http://localhost:8000/docs
```

**That's it!** All services (PostgreSQL, Redis, MinIO, RabbitMQ, WebAuthn, Health API) are now running with coordinated, secure credentials.

For detailed instructions, see [QUICK_START.md](QUICK_START.md)

## ğŸ“ Project Structure

```
health-data-ai-platform/
â”œâ”€â”€ docker-compose.yml              # Main orchestrator (uses include)
â”œâ”€â”€ setup-all-services.sh           # Unified setup script
â”œâ”€â”€ QUICK_START.md                  # 2-minute quick start guide
â”œâ”€â”€ DOCKER_COMPOSE_GUIDE.md         # Detailed Docker Compose docs
â”‚
â”œâ”€â”€ infrastructure/                  # Shared infrastructure services
â”‚   â”œâ”€â”€ setup-secure-env.sh         # Generates secure credentials
â”‚   â”œâ”€â”€ postgres.compose.yml        # PostgreSQL (multi-database)
â”‚   â”œâ”€â”€ redis.compose.yml           # Redis cache & sessions
â”‚   â”œâ”€â”€ jaeger.compose.yml          # Distributed tracing
â”‚   â””â”€â”€ webauthn.compose.yml        # WebAuthn authentication server
â”‚
â”œâ”€â”€ services/                        # Microservices
â”‚   â”œâ”€â”€ health-api-service/         # FastAPI upload service âœ… Complete
â”‚   â”œâ”€â”€ message-queue/              # RabbitMQ processing âœ… Complete
â”‚   â”œâ”€â”€ data-lake/                  # MinIO storage âœ… Complete
â”‚   â”œâ”€â”€ etl-narrative-engine/       # Clinical data processing (planned)
â”‚   â””â”€â”€ ai-query-interface/         # MLflow AI queries (planned)
â”‚
â”œâ”€â”€ docs/                            # Documentation
â”‚   â””â”€â”€ architecture/                # Implementation plans
â”‚
â””â”€â”€ .github/workflows/              # CI/CD pipelines
```

## ğŸ³ Docker Compose Architecture

This project uses a **modular Docker Compose architecture** with reusable service definitions:

- **No duplication** - Each service defined once
- **Include directive** - Main `docker-compose.yml` includes service-specific compose files
- **Shared network** - All services communicate via `health-platform-net`
- **WebAuthn integration** - Uses published Docker image from [mpo-api-authn-server](https://github.com/hitoshura25/mpo-api-authn-server)

**Services included:**
- PostgreSQL (multi-database: healthapi, webauthn)
- Redis (cache & sessions)
- Jaeger (distributed tracing)
- WebAuthn Server (passkey authentication)
- MinIO (S3-compatible storage)
- RabbitMQ (message queue)
- Health API (main application)

See [DOCKER_COMPOSE_GUIDE.md](DOCKER_COMPOSE_GUIDE.md) for detailed documentation.

## ğŸ§ª Running Tests

All services use their own `.env` files generated by `setup-all-services.sh`. Tests automatically load these configurations.

### Health API Integration Tests

```bash
cd services/health-api-service
source .venv/bin/activate
pytest tests/ -v
```

### Data Lake Tests

```bash
cd services/data-lake
source .venv/bin/activate
pytest tests/ -v
```

### Message Queue Tests

```bash
cd services/message-queue
source .venv/bin/activate
pytest tests/ -v
```

**Note:** Make sure Docker services are running (`docker compose up -d`) before running tests.

## ğŸ“Š Implementation Order

The services should be implemented in this order based on dependencies:

1. **Message Queue** + **Data Lake** (parallel) - Foundation services
2. **Health API Service** - User-facing upload interface
3. **ETL Narrative Engine** - Clinical data processing
4. **AI Query Interface** - Natural language queries

## ğŸ“„ License

Apache 2.0

## ğŸ†˜ Support

- **Issues**: Report issues via GitHub Issues
- **Documentation**: Check `docs/` directory
- **Implementation Plans**: See `services/{service}/implementation_plan.md`
- **Architecture**: Review `docs/architecture/implementation_plan_optimal_hybrid.md`