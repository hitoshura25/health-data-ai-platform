# ETL Narrative Engine - Environment Configuration
# Copy this file to .env and configure for your environment

# =============================================================================
# Service Configuration
# =============================================================================
ETL_SERVICE_NAME=etl-narrative-engine
ETL_VERSION=v3.0
ETL_ENVIRONMENT=development  # development, staging, production

# =============================================================================
# Message Queue (RabbitMQ)
# =============================================================================
ETL_RABBITMQ_URL=amqp://guest:guest@localhost:5672/
ETL_QUEUE_NAME=health_data_processing
ETL_EXCHANGE_NAME=health_data_exchange
ETL_EXCHANGE_TYPE=topic
ETL_ROUTING_KEY_PATTERN=health.processing.#
ETL_DEAD_LETTER_QUEUE=health_data_dlq
ETL_PREFETCH_COUNT=1

# Retry configuration
ETL_MAX_RETRIES=3
# Retry delays in seconds: 30s, 5m, 15m
ETL_RETRY_DELAYS=[30, 300, 900]

# =============================================================================
# Storage (S3/MinIO)
# =============================================================================
ETL_S3_ENDPOINT_URL=http://localhost:9000
ETL_S3_ACCESS_KEY=minioadmin
ETL_S3_SECRET_KEY=minioadmin
ETL_S3_BUCKET_NAME=health-data
ETL_S3_REGION=us-east-1
ETL_S3_USE_SSL=false

# =============================================================================
# Deduplication
# =============================================================================
# Options: sqlite, redis
ETL_DEDUPLICATION_STORE=sqlite

# SQLite configuration
ETL_DEDUPLICATION_DB_PATH=/data/etl_processed_messages.db

# Redis configuration (alternative)
ETL_DEDUPLICATION_REDIS_URL=redis://localhost:6379/2

# Retention period in hours (7 days)
ETL_DEDUPLICATION_RETENTION_HOURS=168

# =============================================================================
# Processing Limits
# =============================================================================
ETL_MAX_FILE_SIZE_MB=100
ETL_PROCESSING_TIMEOUT_SECONDS=300
ETL_DATA_QUALITY_THRESHOLD=0.7

# =============================================================================
# Output Paths in S3
# =============================================================================
ETL_TRAINING_DATA_PREFIX=training
ETL_QUARANTINE_PREFIX=quarantine
ETL_RAW_DATA_PREFIX=raw

# =============================================================================
# Observability - Metrics
# =============================================================================
ETL_ENABLE_METRICS=true
ETL_METRICS_PORT=8004

# =============================================================================
# Observability - Jaeger Tracing
# =============================================================================
# Enable distributed tracing with Jaeger (from webauthn-stack)
ETL_ENABLE_JAEGER_TRACING=false

# Jaeger OTLP endpoint (gRPC)
# Use host.docker.internal when running in Docker to access Jaeger on host
ETL_JAEGER_OTLP_ENDPOINT=http://localhost:4319

# Service name for tracing
ETL_JAEGER_SERVICE_NAME=etl-narrative-engine

# =============================================================================
# Development Mode
# =============================================================================
ETL_DEVELOPMENT_MODE=true
ETL_RETRY_DELAY_SECONDS=5

# =============================================================================
# Logging
# =============================================================================
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
ETL_LOG_LEVEL=INFO

# JSON logging for production, human-readable for development
ETL_LOG_JSON=false
